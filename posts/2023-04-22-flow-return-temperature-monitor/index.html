<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Monitoring the flow and return temperature of my heating system - noegel.io</title><link rel=stylesheet href=/custom.css><style>.book_cover img{_height:300px!important}.book-gallery figcaption{text-align:left}.modal{display:none;position:fixed;z-index:1000;padding-top:100px;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:#000;background-color:rgba(0,0,0,.9)}.modal-content{margin:auto;display:block;width:80%;max-width:700px}#caption{margin:auto;display:block;width:80%;max-width:700px;text-align:center;color:#ccc;padding:10px 0;height:150px}.modal-content,#caption{animation-name:zoom;animation-duration:.6s}@keyframes zoom{from{transform:scale(0)}to{transform:scale(1)}}.closeModal{z-index:-99999;position:absolute;top:15px;right:35px;color:#f1f1f1;font-size:40px;font-weight:700;transition:.3s}.closeModal:hover,.closeModal:focus{color:#bbb;text-decoration:none;cursor:pointer}@media only screen and (max-width:700px){.modal-content{width:100%}}</style><meta name=Description content><meta property="og:title" content="Monitoring the flow and return temperature of my heating system"><meta property="og:description" content="To better understand the efficiency and behaviour of my old gas heater, I created a simple monitor for flow and return temperatures."><meta property="og:type" content="article"><meta property="og:url" content="https://noegel.io/posts/2023-04-22-flow-return-temperature-monitor/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-04-22T18:48:00+02:00"><meta property="article:modified_time" content="2023-04-22T18:48:00+02:00"><meta property="og:site_name" content="Daniel Nögel"><meta name=twitter:card content="summary"><meta name=twitter:title content="Monitoring the flow and return temperature of my heating system"><meta name=twitter:description content="To better understand the efficiency and behaviour of my old gas heater, I created a simple monitor for flow and return temperatures."><meta name=application-name content="Daniel Nögel"><meta name=apple-mobile-web-app-title content="Daniel Nögel"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://noegel.io/posts/2023-04-22-flow-return-temperature-monitor/><link rel=prev href=https://noegel.io/posts/2023-03-08-heizwerte2/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Monitoring the flow and return temperature of my heating system","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/noegel.io\/posts\/2023-04-22-flow-return-temperature-monitor\/"},"genre":"posts","wordcount":499,"url":"https:\/\/noegel.io\/posts\/2023-04-22-flow-return-temperature-monitor\/","datePublished":"2023-04-22T18:48:00+02:00","dateModified":"2023-04-22T18:48:00+02:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Daniel"},"description":""}</script><script>(function(e,t,n,s,o){s[o]=s[o]||function(){(s[o].q=s[o].q||[]).push(arguments)};var i,a=e.getElementsByTagName(t)[0];if(e.getElementById(n))return;i=e.createElement(t),i.id=n,i.onload=function(){},i.async=!0,i.src="https://cdn.trackboxx.info/p/tracker.js",a.parentNode.insertBefore(i,a)})(document,"script","trackboxx-script",window,"trackboxx"),trackboxx("set","siteId","TB-60422104"),trackboxx("trackPageview")</script></head><body data-header-desktop=fixed data-header-mobile=auto><div id=myModal class=modal><span class=closeModal>&#215;</span>
<img class=modal-content id=img01><div id=caption></div></div><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title=noegel.io>noegel.io</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/about/>About </a><a class=menu-item href=/read/>Reading </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=noegel.io>noegel.io</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/about/ title>About</a><a class=menu-item href=/read/ title>Reading</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Monitoring the flow and return temperature of my heating system</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Daniel</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2023-04-22>2023-04-22</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;499 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;3 minutes&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#the-idea>The idea</a></li><li><a href=#the-circuit>The circuit</a></li><li><a href=#the-sketch>The sketch</a></li><li><a href=#the-result>The result</a></li></ul></nav></div></div><div class=content id=content><p>To better understand the efficiency and behaviour of my old gas heater, I created a simple monitor for flow and return temperatures.</p><h2 id=the-idea>The idea</h2><p>When planning to switch from old gas heaters to e.g. a heat pump or when just wanting to save gas it can be useful to understand,
if (a) the gas heater is able to run on lower flow temperatures and (b) if it is dimensioned the correct way. With my <a href=/posts/2022-10-12-gaszaehler rel>smarten gas meter (DE)</a>
and my <a href=/posts/2022-10-29-heizlastberechnung rel>heat load calculation (DE)</a> I already have a good understanding - and still wanted to understand better, how my heating system is working.</p><h2 id=the-circuit>The circuit</h2><p>For the circuit I am using one of my trusted ESP32 and a DS18b20 temperature sensor. After connecting voltage & ground the data pin (middle) is connected with Pin 3 and a 4.7kΩ resistor bridges data with V+</p><div class=gallery-grid><figure style=font-size:small;margin:auto><img src=/images/flow-return-monitor/schematics.png><figcaption>Schematic overview of the circuit</figcaption></figure></div><table><thead><tr><th style=text-align:left>DS18b20</th><th>Description</th><th style=text-align:right>ESP 32 Pin</th></tr></thead><tbody><tr><td style=text-align:left>Voltage</td><td></td><td style=text-align:right>Voltage</td></tr><tr><td style=text-align:left>Ground</td><td></td><td style=text-align:right>Ground</td></tr><tr><td style=text-align:left>Data</td><td></td><td style=text-align:right>Pin 3</td></tr><tr><td style=text-align:left>Data</td><td>Bridge with 4.7kΩ resistor</td><td style=text-align:right>Voltage</td></tr></tbody></table><p>With this setup the DS18b20 sensors are attached to the pipes of my heating system, one to the flow and one to the return.</p><h2 id=the-sketch>The sketch</h2><p>The sketch makes use of the libraries <code>OneWire</code> and <code>DallasTemperature</code> and does nothing more than reading those temperatures and sending them to my home automation system (IoBroker) using MQTT.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;OneWire.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;DallasTemperature.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>OneWire <span style=color:#a6e22e>oneWire</span>(ONE_WIRE_BUS);
</span></span><span style=display:flex><span>DallasTemperature <span style=color:#a6e22e>sensors</span>(<span style=color:#f92672>&amp;</span>oneWire);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>char</span> charBuf[<span style=color:#ae81ff>40</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>loop</span>()
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>char</span> tempStr[<span style=color:#ae81ff>10</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  sensors.requestTemperatures();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Sensor 1
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>float</span> temp1 <span style=color:#f92672>=</span> sensors.getTempCByIndex(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>  Serial.print(<span style=color:#e6db74>&#34;Temperature 1: &#34;</span>); Serial.print(temp1);  Serial.println(<span style=color:#e6db74>&#34; °C&#34;</span>);
</span></span><span style=display:flex><span>  dtostrf(temp1, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span>, tempStr); 
</span></span><span style=display:flex><span>  client.publish(<span style=color:#e6db74>&#34;mqtt.0.tempmon.temp1&#34;</span>, tempStr);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Sensor 2
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>float</span> temp2 <span style=color:#f92672>=</span> sensors.getTempCByIndex(<span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>  Serial.print(<span style=color:#e6db74>&#34;Temperature 2: &#34;</span>); Serial.print(temp2); Serial.println(<span style=color:#e6db74>&#34; °C&#34;</span>);  
</span></span><span style=display:flex><span>  dtostrf(temp2, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span>, tempStr); 
</span></span><span style=display:flex><span>  client.publish(<span style=color:#e6db74>&#34;mqtt.0.tempmon.temp2&#34;</span>, tempStr);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  delay(<span style=color:#ae81ff>5000</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>For the full sketch including web updater, wifi setup etc. visit the <a href=https://github.com/dnoegel/temperature-monitor target=_blank rel="noopener noreffer">Temperature Monitor</a> repository.</p><h2 id=the-result>The result</h2><div class=gallery-grid><figure style=font-size:small;margin:auto><img src=/images/flow-return-monitor/flow-return-april.png><figcaption>Flow and return temperatures of a day in april (14°C average temperature that day)</figcaption></figure></div>Looking at a day in april, it can be well seen, that over night the burner did not run and the flow and return temperatures sunk quite substantially. After the initial heating of the house in the morning, there were not too many burner runs.<div class=gallery-grid><figure style=font-size:small;margin:auto><img src=/images/flow-return-monitor/flow-return-march.png><figcaption>Flow and return temperatures of a day in march (4°C average temperature that day</figcaption></figure></div><p>For a colder day in march, the picture is quite different: Not only did the burner run over night a few times - there a substantially more burner runs (i.e. strong reheatings of the flow temperature) throughout the day. From my understanding this is a result of the old gas burner being a bit to big for the house, especially due to window changes and insulation of walls and roof.</p><p>Another interesting finding is, that the max flow temperature always seems to be roughly 50°C. From my understanding this temperature should be depending on the outdoor temperatures (e.g. 55°C for my standard design temperature of -9°C outside and e.g. 40°C for 5°C outside). This seems not to be the case - either due to a defect or the age of my heater.</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2023-04-22</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://noegel.io/posts/2023-04-22-flow-return-temperature-monitor/ data-title="Monitoring the flow and return temperature of my heating system" data-via=danielnoegel><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://noegel.io/posts/2023-04-22-flow-return-temperature-monitor/><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://noegel.io/posts/2023-04-22-flow-return-temperature-monitor/ data-title="Monitoring the flow and return temperature of my heating system"><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=https://noegel.io/posts/2023-04-22-flow-return-temperature-monitor/ data-title="Monitoring the flow and return temperature of my heating system"><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg aria-hidden=true></i></a><a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=https://noegel.io/posts/2023-04-22-flow-return-temperature-monitor/ data-title="Monitoring the flow and return temperature of my heating system"><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/2023-03-08-heizwerte2/ class=prev rel=prev title="Lohnt sich die Dämmung der obersten Geschossdecke? - Februar Update"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>Lohnt sich die Dämmung der obersten Geschossdecke? - Februar Update</a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.104.3">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><span class=imprint><a href=https://noegel.io/data-privacy/>Datenschutz</a></span><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2022 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank></a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><script type=text/javascript src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:60,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script></body><script>document.getElementsByTagName("figure");var list=document.getElementsByTagName("figure"),idx,img,caption,modal=document.getElementById("myModal"),captionText=document.getElementById("caption"),modalImg=document.getElementById("img01"),span=document.getElementsByClassName("closeModal")[0];modal.isVisible=!1,idx=-1;for(let e of list){if(idx++,img=e.getElementsByTagName("img")[0],img===void 0)continue;if(img.idx=idx,caption=e.getElementsByTagName("figcaption")[0],caption!==void 0&&(img.alt=caption.innerText),e.className==="book_cover")continue;img.onclick=function(){modalShow(this)}}span.onclick=function(){modalHide()},modal.onclick=function(){modalHide()};function modalShow(e){modal.style.display="block",modalImg.src=e.src,captionText.innerHTML=e.alt,modal.imgIdx=e.idx,modal.isVisible=!0}function modalHide(){modal.style.display="none",modal.isVisible=!1}function showImage(e){var n=list[e],t=n.getElementsByTagName("img")[0];if(t===void 0)return;modalShow(t)}document.onkeydown=function(e){e=e||window.event;var t,n,s=!1;"key"in e?(t=e.key==="Escape"||e.key==="Esc",n=e.key==="ArrowLeft",s=e.key==="ArrowRight"):(t=e.keyCode===27,n=e.keyCode===37,s=e.keyCode===39),t&&modalHide(),modal.isVisible&&(s&&showImage(Math.min(modal.imgIdx+1,list.length-1)),n&&showImage(Math.max(0,modal.imgIdx-1)))}</script></html>