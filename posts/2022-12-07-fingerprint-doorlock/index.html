<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Opening my front door with a fingerprint sensor - noegel.io</title><link rel=stylesheet href=/custom.css><style>.book_cover img{_height:300px!important}.book-gallery figcaption{text-align:left}.modal{display:none;position:fixed;z-index:1000;padding-top:100px;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:#000;background-color:rgba(0,0,0,.9)}.modal-content{margin:auto;display:block;width:80%;max-width:700px}#caption{margin:auto;display:block;width:80%;max-width:700px;text-align:center;color:#ccc;padding:10px 0;height:150px}.modal-content,#caption{animation-name:zoom;animation-duration:.6s}@keyframes zoom{from{transform:scale(0)}to{transform:scale(1)}}.closeModal{z-index:-99999;position:absolute;top:15px;right:35px;color:#f1f1f1;font-size:40px;font-weight:700;transition:.3s}.closeModal:hover,.closeModal:focus{color:#bbb;text-decoration:none;cursor:pointer}@media only screen and (max-width:700px){.modal-content{width:100%}}</style><meta name=Description content><meta property="og:title" content="Opening my front door with a fingerprint sensor"><meta property="og:description" content="In this simple project I want to build a box that allows my children to enter the house with a fingerprint sensor. At the same time this project doubles as a prototype for video doorbell with fingerprint sensor that I might want to build later.
Prerequisites In my case we are owning a Nuki door lock already: So basically a small box on the inside of my front door that turns the door key when told so via Bluetooth."><meta property="og:type" content="article"><meta property="og:url" content="https://noegel.io/posts/2022-12-07-fingerprint-doorlock/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-12-07T21:11:03+01:00"><meta property="article:modified_time" content="2022-12-07T21:11:03+01:00"><meta property="og:site_name" content="Daniel Nögel"><meta name=twitter:card content="summary"><meta name=twitter:title content="Opening my front door with a fingerprint sensor"><meta name=twitter:description content="In this simple project I want to build a box that allows my children to enter the house with a fingerprint sensor. At the same time this project doubles as a prototype for video doorbell with fingerprint sensor that I might want to build later.
Prerequisites In my case we are owning a Nuki door lock already: So basically a small box on the inside of my front door that turns the door key when told so via Bluetooth."><meta name=application-name content="Daniel Nögel"><meta name=apple-mobile-web-app-title content="Daniel Nögel"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://noegel.io/posts/2022-12-07-fingerprint-doorlock/><link rel=prev href=https://noegel.io/posts/2022-11-05-replace-genius-pro-extruder/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Opening my front door with a fingerprint sensor","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/noegel.io\/posts\/2022-12-07-fingerprint-doorlock\/"},"genre":"posts","wordcount":851,"url":"https:\/\/noegel.io\/posts\/2022-12-07-fingerprint-doorlock\/","datePublished":"2022-12-07T21:11:03+01:00","dateModified":"2022-12-07T21:11:03+01:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Daniel"},"description":""}</script><script>(function(e,t,n,s,o){s[o]=s[o]||function(){(s[o].q=s[o].q||[]).push(arguments)};var i,a=e.getElementsByTagName(t)[0];if(e.getElementById(n))return;i=e.createElement(t),i.id=n,i.onload=function(){},i.async=!0,i.src="https://cdn.trackboxx.info/p/tracker.js",a.parentNode.insertBefore(i,a)})(document,"script","trackboxx-script",window,"trackboxx"),trackboxx("set","siteId","TB-60422104"),trackboxx("trackPageview")</script></head><body data-header-desktop=fixed data-header-mobile=auto><div id=myModal class=modal><span class=closeModal>&#215;</span>
<img class=modal-content id=img01><div id=caption></div></div><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title=noegel.io>noegel.io</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/about/>About </a><a class=menu-item href=/read/>Reading </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=noegel.io>noegel.io</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/about/ title>About</a><a class=menu-item href=/read/ title>Reading</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Opening my front door with a fingerprint sensor</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Daniel</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2022-12-07>2022-12-07</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;851 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;4 minutes&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#prerequisites>Prerequisites</a></li><li><a href=#the-project-build>The project build</a></li><li><a href=#a-word-of-warning>A word of warning</a></li><li><a href=#the-project>The project</a></li></ul></nav></div></div><div class=content id=content><p>In this simple project I want to build a box that allows my children to enter the house with a fingerprint sensor. At the same time this project doubles as a prototype for video doorbell with fingerprint sensor that I might want to build later.</p><h2 id=prerequisites>Prerequisites</h2><p>In my case we are owning a Nuki door lock already: So basically a small box on the inside of my front door that turns the door key when told so via Bluetooth. In my case I am also using the so-called &ldquo;Nuki Bridge&rdquo;: That again is a small box in the hallway that can be told via API to tell the small box on the front door via Bluetooth to turn the key. What a wonderful new world!</p><p>The idea of this project is simple: I will connect a R503 sensor with an ESP32, that will then (if a valid fingerprint is detected) send that API request to the Nuki bridge.</p><p>Similar should be possible for any other smart door lock that has some kind of API. To my understanding it should even work without the Nuki bridge as the ESP32 could also directly communicate with the Nuki door lock via <a href=https://developer.nuki.io/page/nuki-smart-lock-api-2/2 target=_blank rel="noopener noreffer">Bluetooth API</a>. Examples for this are projects such as <a href=https://github.com/I-Connect/NukiBleEsp32 target=_blank rel="noopener noreffer">NukiBleEsp32</a> or <a href=https://github.com/technyon/nuki_hub target=_blank rel="noopener noreffer">Nuki_Hub</a>.</p><p>Long story short, you need:</p><ul><li>an API enabled smart door lock</li><li>an ESP32 (or another microcontroller that has (depending on your door lock) Wifi or Bluetooth connectivity)</li><li>a R503 fingerprint sensor</li></ul><h2 id=the-project-build>The project build</h2><p>Everyone in the software industry knows: Nothing holds longer than a prototype. So I decided to invest some extra effort to make the box for the fingerprint sensor &ldquo;somewhat nice&rdquo;. It ended up being more on the beefy sides of things… but it serves its purpose.</p><div class=gallery-grid><figure style=font-size:small><img src=/images/fingerprint/gluing.jpeg><figcaption>Gluing the box</figcaption></figure><figure style=font-size:small><img src=/images/fingerprint/glued.jpeg><figcaption>Bringing the pieces together</figcaption></figure><figure style=font-size:small><img src=/images/fingerprint/cover.jpeg><figcaption>As the wood was a bit thick, I had to drill a countersink hole.</figcaption></figure><figure style=font-size:small><img src=/images/fingerprint/board.jpeg><figcaption>The wiring is quite easy, as the r503 sensor uses UART. Wires 5 & 6 (blue/white) are not needed in my case.</figcaption></figure></div><h2 id=a-word-of-warning>A word of warning</h2><div class="details admonition warning open"><div class="details-summary admonition-title"><i class="icon fas fa-exclamation-triangle fa-fw" aria-hidden=true></i>Warning<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content>Even though capacitive fingerprint sensors and especially R503 seem to be reasonable well proven: Putting it out there and running home-brewed software to decide if someone should enter your house or not is per se… <del>dumb</del> an idea worth careful consideration.</div></div></div><p>Some possible pitfalls are:</p><ul><li>If the box is accessible an attacker could swap the sensor with an own, preconfigured one (as the fingerprints are stored on the R503). Therefor you should make use of the password functionality of the sensor.</li><li>Make use of the <code>confidence</code> value of the sensor: Only open the door if the sensor is confidence enough about the match.</li><li>The so called FAR (False Acceptance Rate) indicated how likely it is, that the sensor will mistake two different fingers for the same. For R503 I found values such as <code>&lt;0.001%</code> - which is one out of 100.000.</li><li>There could be other attacks to the sensor that I am not aware of.</li><li>There could be stupid programming mistakes that I am not aware of.</li></ul><p>It could therefore also make sense to think twice about:</p><ul><li>if to use this system at all</li><li>where to place it and how visible it should be</li><li>deactivating it for longer journeys</li><li>making it only usable in certain time windows</li><li>ensuring that the ESP is not accessible</li></ul><h2 id=the-project>The project</h2><p>The actual wiring is quite easy:</p><table><thead><tr><th style=text-align:left>R503 Pin</th><th style=text-align:right>R503 Description</th><th style=text-align:right>ESP 32 Pin</th></tr></thead><tbody><tr><td style=text-align:left>1 (red)</td><td style=text-align:right>DC 3.3V</td><td style=text-align:right>3.3V</td></tr><tr><td style=text-align:left>2 (black)</td><td style=text-align:right>Ground</td><td style=text-align:right>Ground</td></tr><tr><td style=text-align:left>3 (yellow)</td><td style=text-align:right>TXD, Output</td><td style=text-align:right>P17</td></tr><tr><td style=text-align:left>4 (brown or green)</td><td style=text-align:right>RXD, Input</td><td style=text-align:right>P16</td></tr></tbody></table><p>The R503 just needs 3.3V from the ESP32 and ground for power supply. Additionally, I connected the yellow TXD Pin of the R503 to P17 Pin of the ESP32 and the brown (sometimes also green) RXD Pin of the R503 to the P16 Pin of the ESP32.</p><p>Using the library manager of the Arduino IDE it is quite simple to use the <a href=https://github.com/adafruit/Adafruit-Fingerprint-Sensor-Library/ target=_blank rel="noopener noreffer">Adafruit Fingerprint Sensor Library</a>. It also includes a lot of examples for registering new fingerprints, checking fingerprints etc.</p><p>The main logic of this project so mainly is arranging this examples in a way that you can trigger a &ldquo;new finger registration&rdquo; by putting your &ldquo;admin&rdquo; finger on the sensor for some longer time. The sensor then blinks and will tell you to show the new finger two times. After that the sensor stores the finger hash internally and will be able to identify the finger in the future.</p><figure style=font-size:small;width:640px;margin:auto><video width=300 controls>
<source src=/images/fingerprint/door2.mov type=video/mp4></video><figcaption>Undoubtedly the bue masking tape adds a lot of charm to the box.</figcaption></figure><p>The rest then again is simple: If the sensor sees a known finger, it will trigger an API Call that - you might guess it - will tell my Nuki bridge via HTTP to tell the Nuki door lock via Bluetooth to turn the key a few times. The door jumps open - and in walk 2 joyfully squealing kids with muddy boots and run with them through the house. With regard to my idea to let the kids in unguarded I just can say: Be careful what you wish for.</p><p>As always the code can be found on <a href=https://github.com/dnoegel/fingerprint-doorlock target=_blank rel="noopener noreffer">Github</a>.</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2022-12-07</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://noegel.io/posts/2022-12-07-fingerprint-doorlock/ data-title="Opening my front door with a fingerprint sensor" data-via=danielnoegel><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://noegel.io/posts/2022-12-07-fingerprint-doorlock/><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://noegel.io/posts/2022-12-07-fingerprint-doorlock/ data-title="Opening my front door with a fingerprint sensor"><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=https://noegel.io/posts/2022-12-07-fingerprint-doorlock/ data-title="Opening my front door with a fingerprint sensor"><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg aria-hidden=true></i></a><a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=https://noegel.io/posts/2022-12-07-fingerprint-doorlock/ data-title="Opening my front door with a fingerprint sensor"><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/2022-11-05-replace-genius-pro-extruder/ class=prev rel=prev title="Replace Genius Pro Extruder"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>Replace Genius Pro Extruder</a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.104.3">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><span class=imprint><a href=https://noegel.io/data-privacy/>Datenschutz</a></span><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2022</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank></a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><script type=text/javascript src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:60,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script></body><script>document.getElementsByTagName("figure");var list=document.getElementsByTagName("figure"),idx,img,caption,modal=document.getElementById("myModal"),captionText=document.getElementById("caption"),modalImg=document.getElementById("img01"),span=document.getElementsByClassName("closeModal")[0];modal.isVisible=!1,idx=-1;for(let e of list){if(idx++,img=e.getElementsByTagName("img")[0],img===void 0)continue;if(img.idx=idx,caption=e.getElementsByTagName("figcaption")[0],caption!==void 0&&(img.alt=caption.innerText),e.className==="book_cover")continue;img.onclick=function(){modalShow(this)}}span.onclick=function(){modalHide()},modal.onclick=function(){modalHide()};function modalShow(e){modal.style.display="block",modalImg.src=e.src,captionText.innerHTML=e.alt,modal.imgIdx=e.idx,modal.isVisible=!0}function modalHide(){modal.style.display="none",modal.isVisible=!1}function showImage(e){var n=list[e],t=n.getElementsByTagName("img")[0];if(t===void 0)return;modalShow(t)}document.onkeydown=function(e){e=e||window.event;var t,n,s=!1;"key"in e?(t=e.key==="Escape"||e.key==="Esc",n=e.key==="ArrowLeft",s=e.key==="ArrowRight"):(t=e.keyCode===27,n=e.keyCode===37,s=e.keyCode===39),t&&modalHide(),modal.isVisible&&(s&&showImage(Math.min(modal.imgIdx+1,list.length-1)),n&&showImage(Math.max(0,modal.imgIdx-1)))}</script></html>